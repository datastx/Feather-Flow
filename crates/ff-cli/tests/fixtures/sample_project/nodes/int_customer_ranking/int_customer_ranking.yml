version: 1
kind: sql

description: "Customer ranking with LEFT JOIN to test nullable metrics"
owner: data-team
tags:
  - intermediate
  - customers

columns:
  - name: customer_id
    type: INTEGER
    description: "Unique customer identifier"
    classification: pii
    tests:
      - unique
      - not_null
  - name: customer_name
    type: VARCHAR
    description: "Customer full name"
    classification: pii
  - name: lifetime_value
    type: DECIMAL(10,2)
    description: "Total amount spent across all orders"
  - name: value_or_zero
    type: DECIMAL(10,2)
    description: "Lifetime value with zero default via COALESCE"
  - name: nonzero_orders
    type: INTEGER
    description: "Order count or NULL if zero via NULLIF"
